# yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/playground/refs/heads/main/schemas/json/v3/validatingpolicy-policies.kyverno.io-v1alpha1.json
apiVersion: policies.kyverno.io/v1alpha1
kind: ValidatingPolicy
metadata:
  name: policy
spec:
  evaluation:
    mode: HTTP
  matchConditions:
  - name: match-host
    expression: |
      object.path.startsWith("/get")
  validations:
  - expression: >
      "bar" in object.header[?"Foo"].orValue([])
        ?  http.Response(200)
        :  http.Response(403).WithBody("the needed header was missing")
